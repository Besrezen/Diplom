
# GNN for Digital Circuits: Delay & Area Prediction

–ì—Ä–∞—Ñ–æ–≤—ã–µ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ (PyTorch Geometric) –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –∫–æ–º–±–∏–Ω–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å—Ö–µ–º:
- **Delay** (–∑–∞–¥–µ—Ä–∂–∫–∞)
- **Area** (–ø–ª–æ—â–∞–¥—å)

–ú–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **GraphSAGE** + –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø—É–ª–ª–∏–Ω–≥–∏ –∏ –ø—Ä–æ—Å—Ç—ã–µ –≥—Ä–∞—Ñ–æ–≤—ã–µ/–¥–æ–º–µ–Ω–Ω–æ-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ —É–∑–ª–æ–≤/–≥—Ä–∞—Ñ–∞.

---

## üì¶ –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```
.
‚îú‚îÄ‚îÄ convert_graphml_to_pickle.py  # –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç pickle
‚îú‚îÄ‚îÄ Graph_Network_Area            # —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –º–æ–¥–µ–ª–∏ –ø–ª–æ—â–∞–¥–∏
‚îú‚îÄ‚îÄ Graph_Network_Delay           # —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –º–æ–¥–µ–ª–∏ –∑–∞–¥–µ—Ä–∂–∫–∏
‚îú‚îÄ‚îÄ metadata.json                 # –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ (—Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å–∫—Ä–∏–ø—Ç–∞–º–∏)
‚îú‚îÄ‚îÄ best_area_gnn.pth             # –≤–µ—Å–∞ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –¥–ª—è area (—Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å–∫—Ä–∏–ø—Ç–æ–º)
‚îú‚îÄ‚îÄ final_gnn_model.pth           # –≤–µ—Å–∞ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –¥–ª—è delay (—Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å–∫—Ä–∏–ø—Ç–æ–º)
‚îî‚îÄ‚îÄ plots/
    ‚îú‚îÄ‚îÄ true_vs_pred_area.png
    ‚îú‚îÄ‚îÄ learning_curves.png
    ‚îú‚îÄ‚îÄ target_dist_area.png
    ‚îú‚îÄ‚îÄ true_vs_pred_delay.png
    ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ dataset/
    ‚îú‚îÄ‚îÄ .Graphml
    ‚îú‚îÄ‚îÄ .json
    ‚îú‚îÄ‚îÄ .pickle
    ‚îî‚îÄ‚îÄ ...
```

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ.** –ü—É—Ç–∏ –∫ –¥–∞—Ç–∞—Å–µ—Ç—É –≤ –∫–æ–¥–µ –∑–∞–¥–∞–Ω—ã –∫–∞–∫ `E:/0_no_firrtl_bench/...`. –ü–æ–º–µ–Ω—è–π—Ç–µ –Ω–∞ —Å–≤–æ–∏, –µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è.

---

## üß© –î–∞–Ω–Ω—ã–µ –∏ –ø—Ä–∏–∑–Ω–∞–∫–∏

### –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö
- –ù–∞ –¥–∏—Å–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã **pickle**-–≥—Ä–∞—Ñ—ã (`<name>.pkl`) —Å –æ–±—ä–µ–∫—Ç–∞–º–∏ **NetworkX** –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ö–µ–º—ã.
- –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ö–µ–º—ã —Ç–∞–∫–∂–µ –µ—Å—Ç—å `<name>AbcStats.json` —Å —Å–µ–∫—Ü–∏–µ–π `abcStatsBalance` (—Å—Ç–∞—Ç—ã –ø–æ—Å–ª–µ ABC).

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫:
```
.../bench_folder/
    ‚îú‚îÄ‚îÄ circuit_0001/
    ‚îÇ   ‚îú‚îÄ‚îÄ circuit_0001.pkl
    ‚îÇ   ‚îî‚îÄ‚îÄ circuit_0001AbcStats.json
    ‚îú‚îÄ‚îÄ circuit_0002/
    ‚îî‚îÄ‚îÄ ...
```

### –£–∑–ª–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
- **one-hot —Ç–∏–ø —ç–ª–µ–º–µ–Ω—Ç–∞** (`node['type']`)
- **–Ω–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–µ–ø–µ–Ω—å**

### –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (–¥–ª—è Area)
–ò–∑ `abcStatsBalance` + —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ:
- `#nodes`, `#edges`, `inputs`, `outputs`, `lev`, `nd`, `edge`

---

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–û–±–µ –∑–∞–¥–∞—á–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å—Ö–æ–∂—É—é –º–æ–¥–µ–ª—å:

- 3 √ó **GraphSAGE** (+ **BatchNorm**, **ReLU**, **Dropout**)
- **GlobalMeanPool** ‚äï **GlobalMaxPool**
- MLP-–≥–æ–ª–æ–≤–∞

–†–∞–∑–ª–∏—á–∏—è:
- **Delay:** `hidden_dim=512`, loss = **SmoothL1Loss** (Huber), —à–µ–¥—É–ª–µ—Ä **CosineAnnealingLR**
- **Area:** `hidden_dim=256`, loss = **HuberLoss**, —à–µ–¥—É–ª–µ—Ä **ReduceLROnPlateau**, –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è **–≥–ª–æ–±–∞–ª—å–Ω—ã—Ö —Ñ–∏—á** –∫ pooled-–≤–µ–∫—Ç–æ—Ä—É.


### Area
- **R¬≤ = 0.70**
- **MAPE ‚âà 72%**
- **MAE ‚âà 8 000** (–ø–æ —Ç–æ—á–∫–∞–º –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ)


### Delay
- **R¬≤ = 0.83**
- **MAPE ‚âà 85%**
- **MAE ‚âà 180**

---

## üñº –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏

–°–∫—Ä–∏–ø—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç –≤ `./plots/`:

- `learning_curves*.png` ‚Äî –∫—Ä–∏–≤—ã–µ –æ–±—É—á–µ–Ω–∏—è
- `true_vs_pred*.png` ‚Äî —Ñ–∞–∫—Ç—ã vs –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è (+ –¥–∏–∞–≥–æ–Ω–∞–ª—å *y=x*)
- `residuals_hist.png` ‚Äî —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Å—Ç–∞—Ç–∫–æ–≤
- `residuals_vs_true.png` ‚Äî –æ—Å—Ç–∞—Ç–∫–∏ vs –∏—Å—Ç–∏–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- `target_dist*.png` ‚Äî —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∞—Ä–≥–µ—Ç–∞
